<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-API对接/API编排">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<title data-rh="true">API编排 | 爱速搭</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://baidu.gitee.io//aisuda-docs/API对接/API编排"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="API编排 | 爱速搭"><meta data-rh="true" name="description" content="API 编排功能可以通过组合的方式整合处理多个 API / 业务节点的数据，输出业务终端需要的数据结果"><meta data-rh="true" property="og:description" content="API 编排功能可以通过组合的方式整合处理多个 API / 业务节点的数据，输出业务终端需要的数据结果"><link data-rh="true" rel="icon" href="/aisuda-docs/img/favicon.png"><link data-rh="true" rel="canonical" href="https://baidu.gitee.io//aisuda-docs/API对接/API编排"><link data-rh="true" rel="alternate" href="https://baidu.gitee.io//aisuda-docs/API对接/API编排" hreflang="en"><link data-rh="true" rel="alternate" href="https://baidu.gitee.io//aisuda-docs/API对接/API编排" hreflang="x-default"><link rel="stylesheet" href="/aisuda-docs/assets/css/styles.7a31aa11.css">
<link rel="preload" href="/aisuda-docs/assets/js/runtime~main.7fb30cc7.js" as="script">
<link rel="preload" href="/aisuda-docs/assets/js/main.72fed679.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/aisuda-docs/"><div class="navbar__logo"><img src="/aisuda-docs/img/logo.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/aisuda-docs/img/logo.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">爱速搭</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/aisuda-docs/">使用手册</a><a class="navbar__item navbar__link" href="/aisuda-docs/快速入门/使用流程">快速入门</a><a class="navbar__item navbar__link" href="/aisuda-docs/私有部署/私有部署安装">私有部署</a><a class="navbar__item navbar__link" href="/aisuda-docs/OpenAPI/介绍">API</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/aisuda-docs/">返回首页</a><a href="https://aisuda.bce.baidu.com/amis/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">amis 文档<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/aisuda-docs/">产品描述</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/aisuda-docs/组织管理/工作台管理">组织管理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/aisuda-docs/数据模型/外部数据源接入/数据源编辑">数据模型</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/aisuda-docs/页面设计/页面管理">页面设计</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/aisuda-docs/API对接/基础">API对接</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aisuda-docs/API对接/基础">基础</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aisuda-docs/API对接/系统API">系统API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aisuda-docs/API对接/本地开发调试">本地开发调试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aisuda-docs/API对接/API中心">API中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/aisuda-docs/API对接/API编排">API编排</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/aisuda-docs/BPM流程/基础">BPM流程</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/aisuda-docs/小程序/小程序开发实践">小程序</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/aisuda-docs/应用管理/应用设置">应用管理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/aisuda-docs/对象存储/对象存储管理">对象存储</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aisuda-docs/应用发布">应用发布</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/aisuda-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">API对接</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">API编排</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>API编排</h1></header><p>API 编排功能可以通过组合的方式整合处理多个 API / 业务节点的数据，输出业务终端需要的数据结果</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-编排入门">API 编排入门<a class="hash-link" href="#api-编排入门" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="基础">基础<a class="hash-link" href="#基础" title="Direct link to heading">​</a></h3><p>API 编排本质上是一种用可视化的方式来编写后端代码，它可以用于不复杂的接口聚合及增删改查场景。</p><p>API 编排是树形接口，它的执行顺序是从上至下执行，比如下图：</p><p><img loading="lazy" alt="tree" src="/aisuda-docs/assets/images/flow-tree-acf3d01105cc3153a8c7c2267a544cab.png" width="1626" height="794" class="img_ev3q"></p><p>这个 API 编排首先运行「并行执行」节点，这里面的子节点会并行运行，接着是循环节点，可以对前面的输出结果进行循环处理，然后在这个循环里面有个分支判断，如果成功就运行「设置变量」的节点，最后再运行「发送邮件」节点，如果熟悉写代码，上面这个树等价于下面的代码：</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 这个是为了处理并行执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  httpResult </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sendHTTPAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sqlResult </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">runSQL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 对 http 返回结果进行二次处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> item </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> httpResult</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 分支</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 设置变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;成功&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 发送邮件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sendMail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>各个节点之间如何协作？方法是通过变量，比如发起一个 HTTP 接口，其中有个配置是「存入变量」</p><p><img loading="lazy" alt="var" src="/aisuda-docs/assets/images/var-920cae976e439c93ec6c4a0c29c5abfa.png" width="2172" height="594" class="img_ev3q"></p><p>执行完后，下面的节点就能通过这个变量来获取到内容，比如后面接一个「设置变量」的节点，在这个节点中，可以通过 <code>{{}}</code> 来获取到，比如下面这个例子获取到前面 output 变量中的 name 值，然后又将它写入变量 res。</p><p><img loading="lazy" alt="var-set" src="/aisuda-docs/assets/images/var-set-1ae4bedcf818511dfafa30844f18bc87.png" width="1180" height="638" class="img_ev3q"></p><p>当所有节点执行完后，output 变量的值就作为最终结果返回前端。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="创建和编辑">创建和编辑<a class="hash-link" href="#创建和编辑" title="Direct link to heading">​</a></h3><p>在【API 中心】列表中点击【新增 API】，弹出面板选择【多接口聚合模式】，即可新增一个 API 编排</p><p><img loading="lazy" alt="new" src="/aisuda-docs/assets/images/new-e15414ad259217350113ba40c1923186.png" width="2316" height="702" class="img_ev3q"></p><p>保存后在列表中点击【多接口聚合设计】，即可进行整个 API 编排的设计</p><p><img loading="lazy" alt="merge" src="/aisuda-docs/assets/images/merge-3df4e859e2a4e5a6cf38abe82ae54e5d.png" width="2692" height="324" class="img_ev3q"></p><p>点击连线上的 + 号，可添加连线所在层级的平级节点，点击节点右侧的 + 号，可添加该节点的子节点
<img loading="lazy" alt="add" src="/aisuda-docs/assets/images/add-a12534c4328c08ca0871730598960ba7.png" width="1392" height="820" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="一个简单的例子">一个简单的例子<a class="hash-link" href="#一个简单的例子" title="Direct link to heading">​</a></h3><p>本例子将实现一个从服务端获取文章列表并对日期进行格式化后返回到前端的 API 编排</p><p>添加一个 “发送 HTTP 请求” 类型的节点，在 “请求地址” 输入框中填写以下 url</p><p><code>https://3xsw4ap8wah59.cfc-execute.bj.baidubce.com/apiArrangeDemo/list</code></p><p><img loading="lazy" alt="http" src="/aisuda-docs/assets/images/http-c2e53cbddbc7efaa701a469d57812d12.png" width="2198" height="894" class="img_ev3q"></p><p>点击工具栏中的 “调试接口” 按钮
<img loading="lazy" alt="run" src="/aisuda-docs/assets/images/run-988c910c7cabd9db50c64f91e43f90d9.png" width="1680" height="594" class="img_ev3q"></p><p>在弹出框中点击右下角的 “发送请求” 按钮，等待请求执行完毕后，可以看到请求结果和运行日志</p><p><img loading="lazy" alt="send" src="/aisuda-docs/assets/images/send-252d2107604938ec3d9b351fff741308.png" width="1592" height="1422" class="img_ev3q"></p><p>可以看到当前返回的数据是包含 items 和 total 两个字段的 json 格式数据，items 列表单项中的 date 字段是以毫秒时间戳格式返回的日期</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;items&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;id&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;title&quot;: &quot;标题0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;subscribe&quot;: &quot;摘要0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;date&quot;: 1622793580560</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;total&quot;: 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这里我们希望将 date 字段转换为能够友好展示的日期字符串</p><p>为 “发送 HTTP 请求” 节点添加一个平级 “循环” 类型的节点，并为 “循环” 节点添加一个 “日期格式化” 子节点</p><p>“循环” 节点配置如下，接口返回的数据会被统一放在全局的 output 对象中，通过 <code>output.xxx</code> 可以取到相关字段
<img loading="lazy" alt="loop" src="/aisuda-docs/assets/images/loop-73b3bf862604b54af8a0d3e2409561ae.png" width="2200" height="1046" class="img_ev3q"></p><p>“日期格式化” 节点配置如下，循环节点的行为是循环执行自身子节点的逻辑
<img loading="lazy" alt="dateformat" src="/aisuda-docs/assets/images/dateformat-adbfd22ef0691ea688bac6599418cbd2.png" width="2206" height="956" class="img_ev3q"></p><p>点击发送请求，可以看到返回数据中的 date 被格式化成了 <code>YYYY-MM-DD HH:mm:ss</code> 格式</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;items&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;id&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;title&quot;: &quot;标题0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;subscribe&quot;: &quot;摘要0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;date&quot;: &quot;2021-06-04 17:23:41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;total&quot;: 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>调试完之后需要点右下角的 “确认” 按钮保存，编辑界面中的内容才会被保存到数据库中
关于如何在页面中使用 API 编排获取数据，请看下一节</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="在页面中使用-api-编排">在页面中使用 API 编排<a class="hash-link" href="#在页面中使用-api-编排" title="Direct link to heading">​</a></h3><p>在页面中使用 API 编排的方式，和使用 API 中心 API 的方式完全相同，下面同样以一个简单的例子来说明</p><p>新建一个普通页面，在页面中拖入一个增删改查组件</p><p>勾选增删改查组件的数据拉取接口的 “来自 API 中心” 选项，在列表中选择之前创建的 API 编排（和单个接口 API 在同一个列表中）</p><p>配置字段映射，可以看到 API 编排处理返回的数据被正常展示在列表中</p><p><img loading="lazy" alt="crud" src="/aisuda-docs/assets/images/crud-2d4948476e5dfa0e70a1087c1fac3273.png" width="2460" height="1288" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="调试接口">调试接口<a class="hash-link" href="#调试接口" title="Direct link to heading">​</a></h3><p>点击顶部的「调试接口」按钮进入接口调试功能。</p><p><img loading="lazy" alt="debug" src="/aisuda-docs/assets/images/debug-b2d483344b8358371228888e2ac8a38f.png" width="1722" height="514" class="img_ev3q"></p><p>在接口调试弹窗中，可以输入提交参数，然后点击「发送请求」进行测试，除了查看输出结果，最有用的功能是查看执行过程的记录，如下图所示：</p><p><img loading="lazy" alt="debug-result" src="/aisuda-docs/assets/images/debug-result-dba53a59ab94c8f6f87b15478f680eee.png" width="2772" height="734" class="img_ev3q"></p><p>对于初始节点和有数据变更的节点，还能点击旁边的加号来查看当时的数据情况，这样就能知道每一步操作是否正确对数据进行了处理。</p><p><img loading="lazy" alt="debug-state" src="/aisuda-docs/assets/images/debug-state-f42f6a5e0c2f78f2dd2a6d19eba6479e.png" width="2420" height="736" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看配置源码">查看配置源码<a class="hash-link" href="#查看配置源码" title="Direct link to heading">​</a></h3><p>点击顶部的「查看配置源码」可以看到最终生成的树形结构配置，这是 API 编排在实际运行是所使用的格式，这个功能主要是用于结果预期不一致时进行调试，可以将这个配置发给爱速搭的管理员协助分析。</p><p><img loading="lazy" alt="config-source" src="/aisuda-docs/assets/images/config-source-d5ddaa786667e337a5080b01d989998d.png" width="3170" height="1316" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="生成的伪代码示例">生成的伪代码示例<a class="hash-link" href="#生成的伪代码示例" title="Direct link to heading">​</a></h3><p>点击顶部的「生成的伪代码示例」可以生成伪代码示例。</p><p><img loading="lazy" alt="pseudocode" src="/aisuda-docs/assets/images/pseudocode-d9bc6894ad46b077f31b73b54d055a87.png" width="3062" height="1320" class="img_ev3q"></p><p>这个功能主要是给习惯看源码的研发，可以方便看出执行流程，不过需要注意的是爱速搭实际执行并不是使用这个生成的代码，因此这里仅供参考，输出的伪代码并不保证能运行。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="节点分类介绍">节点分类介绍<a class="hash-link" href="#节点分类介绍" title="Direct link to heading">​</a></h2><p>接下来详细介绍各个节点的功能</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据接口">数据接口<a class="hash-link" href="#数据接口" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="发送-http-请求">发送 HTTP 请求<a class="hash-link" href="#发送-http-请求" title="Direct link to heading">​</a></h4><p>最基本的 HTTP 请求发送节点，使用方法同【单个接口 API】，具体见<a href="/aisuda-docs/API对接/API中心">API 中心</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据源-sql">数据源 SQL<a class="hash-link" href="#数据源-sql" title="Direct link to heading">​</a></h4><p>在数据源上执行 SQL 操作。</p><p>在 SQL 语句里用 <code>{{}}</code> 包裹的部分可以执行 JS 语句，实现灵活的处理，比如：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from blog where title = {{ input.title }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>它的实现原理是最终转成 <code>select * from blog where title = ?</code>，然后将 <code>input.title</code> 的值作为后续参数填入，因此默认会进行变量转义，防止 sql 注入</p><p>如果数据是一维数组，使用如下写法</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from blog where title in ({{ input.titles}})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果是二维数组，比如下面的 <code>input.blogs</code> 是 <code>[[&#x27;标题1&#x27;, &#x27;内容1&#x27;], [&#x27;标题2&#x27;, &#x27;内容2&#x27;]]</code>，使用如下写法</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">INSERT INTO blog VALUES {{ input.blogs }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>或者指明字段</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">INSERT INTO blog (title, content) VALUES {{ input.blogs }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果数据是对象数组形式，需要先转成二维数组，可以用 js 节点操作，比如</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module.exports = async function (event, state) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  state.blogs = [state.input.blogs.map(item =&gt; [item.title, item.content])];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return state;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果要实现有参数时才查询，可以用如下写法</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from blog where ( {{ !input.title }} OR title = {{ input.title }} )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这个语句在输入参数有 <code>title</code> 的时候，会变成</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from blog where (FALSE OR title = ?)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果输入参数里没有 <code>title</code>，则会变成下面的语句，可以看到前面的条件是 true，所以 or 里的条件不会生效。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from blog where (TRUE OR title = ?)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="执行控制">执行控制<a class="hash-link" href="#执行控制" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="分支">分支<a class="hash-link" href="#分支" title="Direct link to heading">​</a></h4><p>相当于代码中的 <code>if</code> 语句。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="循环">循环<a class="hash-link" href="#循环" title="Direct link to heading">​</a></h4><p>循环用于对数组进行遍历，它的每个子节点用于执行每次循环的中的语句。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="跳出循环">跳出循环<a class="hash-link" href="#跳出循环" title="Direct link to heading">​</a></h4><p>用于跳出循环，不再执行循环的后续所有操作，相当于代码中的 <code>break</code> 语句。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="继续循环">继续循环<a class="hash-link" href="#继续循环" title="Direct link to heading">​</a></h4><p>用于跳过当前循环的后续操作，进入下一个循环，相当于代码中的 <code>continue</code> 语句。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="退出">退出<a class="hash-link" href="#退出" title="Direct link to heading">​</a></h4><p>用于退出整个接口，后续不再执行任何操作</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="并行串行">并行/串行<a class="hash-link" href="#并行串行" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="顺序执行">顺序执行<a class="hash-link" href="#顺序执行" title="Direct link to heading">​</a></h4><p>按顺序执行子节点</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="并行执行">并行执行<a class="hash-link" href="#并行执行" title="Direct link to heading">​</a></h4><p>这个节点下的子节点会并行执行，用于独立获取各种数据的场景。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据处理">数据处理<a class="hash-link" href="#数据处理" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="设置变量">设置变量<a class="hash-link" href="#设置变量" title="Direct link to heading">​</a></h4><p>赋值语句，用于对变量进行赋值。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="日期格式化">日期格式化<a class="hash-link" href="#日期格式化" title="Direct link to heading">​</a></h4><p>对日期格式进行转换，比如将时间戳转成可读的日期格式。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="js-代码">JS 代码<a class="hash-link" href="#js-代码" title="Direct link to heading">​</a></h4><p>通过 js 代码的方式来对数据进行处理，用于处理一些比较复杂的数据转换场景。</p><p>最简单的示例如下</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中 state 是 api 编排中的全局数据，比如前面如果有个 HTTP 节点将返回结果「存入变量」到 data 下，在 JS 代码中就能通过 <code>state.data</code> 获取到这个值，然后进行二次转换。</p><p>同时还能写入 <code>state.output</code> 来影响 api 聚合最终的输出结果。</p><p>这段 JS 函数的返回值会替换全局数据，因此上面的例子中直接返回 <code>state</code>。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="其他">其他<a class="hash-link" href="#其他" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="发送邮件">发送邮件<a class="hash-link" href="#发送邮件" title="Direct link to heading">​</a></h4><p>用于发送邮件，比如进行邮件通知</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="session">session<a class="hash-link" href="#session" title="Direct link to heading">​</a></h4><p>有一个特殊的全局变量 session，它会在整个用户会话中存储，如果写入这个变量，下次再次请求的时候还能读取到。</p><p>这个变量的值可以是字符串，也可以是对象，但整体大小限制在 2k 字节。</p><p>session 是应用级别隔离，不同应用在不同环境下是独立的。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/aisuda/aisuda-docs/edit/main/docs/API对接/API编排.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/aisuda-docs/API对接/API中心"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">API中心</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/aisuda-docs/BPM流程/基础"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">基础</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#api-编排入门" class="table-of-contents__link toc-highlight">API 编排入门</a><ul><li><a href="#基础" class="table-of-contents__link toc-highlight">基础</a></li><li><a href="#创建和编辑" class="table-of-contents__link toc-highlight">创建和编辑</a></li><li><a href="#一个简单的例子" class="table-of-contents__link toc-highlight">一个简单的例子</a></li><li><a href="#在页面中使用-api-编排" class="table-of-contents__link toc-highlight">在页面中使用 API 编排</a></li><li><a href="#调试接口" class="table-of-contents__link toc-highlight">调试接口</a></li><li><a href="#查看配置源码" class="table-of-contents__link toc-highlight">查看配置源码</a></li><li><a href="#生成的伪代码示例" class="table-of-contents__link toc-highlight">生成的伪代码示例</a></li></ul></li><li><a href="#节点分类介绍" class="table-of-contents__link toc-highlight">节点分类介绍</a><ul><li><a href="#数据接口" class="table-of-contents__link toc-highlight">数据接口</a></li><li><a href="#执行控制" class="table-of-contents__link toc-highlight">执行控制</a></li><li><a href="#并行串行" class="table-of-contents__link toc-highlight">并行/串行</a></li><li><a href="#数据处理" class="table-of-contents__link toc-highlight">数据处理</a></li><li><a href="#其他" class="table-of-contents__link toc-highlight">其他</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/aisuda-docs/assets/js/runtime~main.7fb30cc7.js"></script>
<script src="/aisuda-docs/assets/js/main.72fed679.js"></script>
</body>
</html>